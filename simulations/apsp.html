<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Requirements</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Requirements</h1>

<p>The following libraries must be installed:</p>

<pre><code class="r">library(Rcpp)
library(pracma)
</code></pre>

<h1>Introduction</h1>

<p>Let \(A\) be an \(n \times n\) symmetric weighted adjacency matrix, with
\[
A_{ij} = \begin{cases}
0 & \text{ if }i = j\
A_{ij} & \text{ if there is an edge from $i$ to $j$,}\
\infty & \text{ if there is no edge from $i$ to $j$}
\end{cases}
\]</p>

<h1>Min-plus multiplication</h1>

<p>For \(X_{n \times k}\), \(Y_{k \times m}\), define \(X \otimes Y = Z_{n \times m}\) by:
\[
Z_{ij} = \min_{l = 1}^k X_{ik} + Y_{kj}
\]</p>

<p>The code for min-plus is as follows</p>

<pre><code class="r">library(Rcpp)
cppFunction(&#39;
NumericMatrix minplus(NumericMatrix Ar, NumericMatrix Br) {
  int n = Ar.nrow();
  int l = Ar.ncol();
  int m = Br.ncol();
  NumericMatrix ans(n, m);
  for (int i = 0; i &lt; n; i++) {
    for (int j = 0; j &lt; m; j++) {
      for (int k = 0; k &lt; l; k++) {
        double x = Ar(i, k) + Br(k, j);
        if (x &lt; ans(i, j) || k == 0) {
          ans(i, j) = x;
        }
      }
    }
  }
  return ans;
}
&#39;
)
</code></pre>

<h2>Demo</h2>

<p>Create a geometric graph on the unit square.</p>

<pre><code class="r">set.seed(3)
n &lt;- 5
eps &lt;- 0.5
x &lt;- matrix(runif(n * 2), n, 2)
dm &lt;- distmat(x, x)
adj &lt;- (dm &lt; eps) + 0
plot(x, pch = &quot;.&quot;)
for (i in 1:n) {
  for (j in 1:n) {
    if (adj[i,j] == 1) {
      lines(x[, 1][c(i, j)], x[, 2][c(i, j)], col = gray(.5))
      mid &lt;- (x[i, ] + x[j, ])/2
      if (i != j) text(mid[1], mid[2], substr(paste(dm[i, j]), 0, 4))
    }
  }
}
for (i in 1:n) points(x[i, 1], x[i, 2], pch = paste(i), cex = 1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<p>Form the weighted graph matrix \(A\) in the format specified previously.</p>

<pre><code class="r">A &lt;- dm * adj
A[A == 0] &lt;- Inf
diag(A) &lt;- 0
A
</code></pre>

<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 0.0000000       Inf 0.3781769 0.1619234 0.4348725
## [2,]       Inf 0.0000000 0.4554753       Inf       Inf
## [3,] 0.3781769 0.4554753 0.0000000 0.2887332 0.4003850
## [4,] 0.1619234       Inf 0.2887332 0.0000000 0.2795088
## [5,] 0.4348725       Inf 0.4003850 0.2795088 0.0000000
</code></pre>

<p>The shortest length 2 path from node 1 to 2 should be</p>

<pre><code class="r">A2 &lt;- minplus(A, A)
A2[1, 2]
</code></pre>

<pre><code>## [1] 0.8336522
</code></pre>

<p>Is this correct&hellip;? Check the plot.</p>

<h1>Floyd-Warshall and Iterative Squaring</h1>

<p>All-pairs shortest paths can either be computed by iterative squaring or Floyd-Warshall</p>

<h2>Iterative squaring</h2>

<p>Iterative squaring uses \(log(n)\) iterations and costs \(n^3\) per iteration.</p>

<p>Each iterate of the algorithm performs the following:</p>

<p>\[
A \leftarrow A \otimes A
\]</p>

<p>Code:</p>

<pre><code class="r">iter_square &lt;- function(a) {
  n &lt;- dim(a)[1]
  n_its &lt;- ceiling(log(n)/log(2))
  for (i in 1:n_its) a &lt;- minplus(a, a)
  a
}
</code></pre>

<h2>Floyd-Warshall</h2>

<p>Floyd-Warshall uses \(n\) iterations and costs \(n^2\) per iteration.</p>

<p>Let \(A_k\) denote the \(k\) th column of \(A\)
The \(k\) th iteration of Floyd-Warshall computes</p>

<p>\[
A \leftarrow min(A, A_k \otimes A_k^T)
\]</p>

<p>Code:</p>

<pre><code class="r">floyd_warshall &lt;- function(a) {
  n &lt;- dim(a)[1]
  for (k in 1:n) {
    Ak &lt;- a[, k, drop = FALSE]
    a &lt;- pmin(a, minplus(Ak, t(Ak)))
  }
  a
}
</code></pre>

<h2>Demo</h2>

<p>Check that both give the same result</p>

<pre><code class="r">A_is &lt;- iter_square(A)
A_fw &lt;- floyd_warshall(A)
sum(A_is != A_fw)
</code></pre>

<pre><code>## [1] 0
</code></pre>

<h1>Generalizing Floyd-Warshall</h1>

<p>Both Floyd-Warshall and iterated squaring can be viewed as generalizations of the same algorithm, &ldquo;block Floyd-Warshall&rdquo;.
Let \(K\) be a number of blocks such that \(mk = n\).  Then let
\[A = [B_1, B_2, &hellip;, B_K]\]
where each \(B_i\) is \(n \times m\).</p>

<p>Block Floyd-Warshall has \(L\) main iterations.
Within each main iterate, there are \(K\) subiterations, where on the $k$th subiterate,
\[
A \leftarrow \min(A, B_k \otimes B_k^T)
\]</p>

<ul>
<li>Floyd-Warshall is the special case where \(L=1\) and \(K = n\).</li>
<li>Iterated squaring is the special case where \(L = \log(n)\) and \(K = 1\).</li>
<li>What about intermediate cases of \(L\), \(k\)??</li>
</ul>

<p>The number of iterations is \(LK\) and the cost per iteration is \(n^3/K\).
In general, block Floyd-Warshall will <em>not</em> compute the correct all-pairs-shortest-paths matrix.
So why should we care?  See the writeup <code>apsp_theory.pdf</code>.</p>

<p>Code is as follows:</p>

<pre><code class="r">block_fw &lt;- function(a, K, l) {
  n &lt;- dim(a)[1]
  m &lt;- ceiling(n/K)
  for (main_it in 1:l) {
    for (k in 1:K) {
      Bk &lt;- a[, ((k-1) * m + 1):min(n, k * m), drop = FALSE]
      a &lt;- pmin(a, minplus(Bk, t(Bk)))
    }
  }
  a
}
</code></pre>

<h2>Demo</h2>

<p>Compare block FW with \(K= 3\) and \(L = 1\) to the correct distance matrix</p>

<pre><code class="r">A_bfw &lt;- block_fw(A, 3, 1)
plot(A_is, A_bfw)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-10"/> </p>

<p>In this case, it is exact.</p>

<h1>Next</h1>

<p>See the writeup <code>manuscript/apsp.pdf</code> and the R markdown <code>simulations/block_fw.Rmd</code>.</p>

</body>

</html>
